<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Japanese Flashcards</title>
<style>
    body {
        margin: 0;
        font-family: sans-serif;
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        display: flex;
        flex-direction: column;
        height: 100vh;
    }
    #controls {
        background: rgba(0,0,0,0.8);
        color: white;
        padding: 10px;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    #bg-controls {
        display: flex;
        align-items: center;
        gap: 5px;
    }
    #card {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    .card-content {
        background: rgba(255,255,255,var(--card-opacity,0.45));
        padding: 40px;
        border-radius: 10px;
        max-width: 80%;
        text-align: center;
    }
    button {
        padding: 6px 12px;
        margin: 0 3px;
        cursor: pointer;
    }
</style>
</head>
<body>

<div id="controls">
    <div id="mode-controls">
        <button id="learn-btn">Learn</button>
        <button id="review-btn">Review</button>
        <button id="drill-btn">Drill</button>
    </div>
    <div id="bg-controls" style="margin-left:auto;">
        <label>Background:</label>
        <input type="file" id="bg-upload" accept="image/*">
        <input type="range" id="opacity-slider" min="0.1" max="1" step="0.05" value="0.45" title="Card Opacity">
    </div>
</div>

<div id="card">
    <div class="card-content" id="card-content">Loading...</div>
</div>

<script>
let state = {
    bgRemoteList: '',
    cardOpacity: 0.45,
    mode: 'learn',
    cards: [
        { front: '猫', back: 'Cat' },
        { front: '犬', back: 'Dog' },
        { front: '水', back: 'Water' }
    ],
    currentCardIndex: 0
};

function updateCard() {
    const cardEl = document.getElementById('card-content');
    const card = state.cards[state.currentCardIndex];
    cardEl.innerHTML = `<div style="font-size:2em;">${card.front}</div><div>${card.back}</div>`;
}

function changeMode(mode) {
    state.mode = mode;
    state.currentCardIndex = 0;
    updateCard();
}

document.getElementById('learn-btn').addEventListener('click', ()=>changeMode('learn'));
document.getElementById('review-btn').addEventListener('click', ()=>changeMode('review'));
document.getElementById('drill-btn').addEventListener('click', ()=>changeMode('drill'));

document.getElementById('bg-upload').addEventListener('change', (e)=>{
    const file = e.target.files[0];
    if (file) {
        const url = URL.createObjectURL(file);
        document.body.style.backgroundImage = `url(${url})`;
    }
});

document.getElementById('opacity-slider').addEventListener('input', (e)=>{
    state.cardOpacity = e.target.value;
    document.documentElement.style.setProperty('--card-opacity', state.cardOpacity);
});

function loadRandomRemoteBackground() {
    const list = (state.bgRemoteList || '').split(/\r?\n+/).map(s => s.trim()).filter(Boolean);
    if (list.length > 0) {
        const randomUrl = list[Math.floor(Math.random() * list.length)];
        document.body.style.backgroundImage = `url(${randomUrl})`;
    }
}

updateCard();
loadRandomRemoteBackground();
</script>
</body>
</html>
